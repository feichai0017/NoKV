work_dir = "./work_test"
value_threshold = 1024

# Memtable & SST
mem_table_size = 67108864 # 64 MiB
mem_table_engine = "skiplist"
sstable_max_sz = 268435456 # 256 MiB

# Write pipeline
write_batch_max_count = 64
write_batch_max_size = 1048576 # 1 MiB
write_batch_wait = "200us"
max_batch_count = 0 # 0 = use write_batch_max_count
max_batch_size = 0 # 0 = use write_batch_max_size

# Value log
value_log_file_size = 0 # 0 = default (512 MiB)
value_log_max_entries = 0 # 0 = auto
value_log_bucket_count = 16
value_log_hot_bucket_count = 4
value_log_hot_key_threshold = 8
value_log_gc_interval = "10m"
value_log_gc_discard_ratio = 0.5
value_log_gc_parallelism = 0 # 0 = auto
value_log_gc_reduce_score = 2.0
value_log_gc_skip_score = 4.0
value_log_gc_reduce_backlog = 0
value_log_gc_skip_backlog = 0
value_log_gc_sample_size_ratio = 0.10
value_log_gc_sample_count_ratio = 0.01
value_log_gc_sample_from_head = false
value_log_verbose = false

# Transactions
detect_conflicts = false

# Hot key tracking (read/write)
hot_ring_enabled = true
hot_ring_bits = 12
hot_ring_topk = 16
hot_ring_rotation_interval = "30m"
hot_ring_node_cap = 250000
hot_ring_node_sample_bits = 0
hot_ring_decay_interval = "0s"
hot_ring_decay_shift = 0
hot_ring_window_slots = 8
hot_ring_window_slot_duration = "250ms"

# Value log HotRing overrides
value_log_hot_ring_override = true
value_log_hot_ring_bits = 12
value_log_hot_ring_rotation_interval = "10m"
value_log_hot_ring_node_cap = 200000
value_log_hot_ring_node_sample_bits = 0
value_log_hot_ring_decay_interval = "0s"
value_log_hot_ring_decay_shift = 0
value_log_hot_ring_window_slots = 6
value_log_hot_ring_window_slot_duration = "100ms"

# Write hot key limits
write_hot_key_limit = 128
hot_write_burst_threshold = 8
hot_write_batch_multiplier = 2

# Cache
block_cache_size = 4096
bloom_cache_size = 1024

# Durability
sync_writes = false
manifest_sync = false
manifest_rewrite_threshold = 67108864 # 64 MiB

# WAL watchdog
enable_wal_watchdog = true
wal_auto_gc_interval = "15s"
wal_auto_gc_min_removable = 1
wal_auto_gc_max_batch = 4
wal_typed_record_warn_ratio = 0.35
wal_typed_record_warn_segments = 6

# Stats
raft_lag_warn_segments = 8

# Discard stats
discard_stats_flush_threshold = 0

# Compaction
num_compactors = 4
num_level_zero_tables = 16
ingest_compact_batch_size = 4
ingest_backlog_merge_score = 2.0
ingest_shard_parallelism = 2
compaction_value_weight = 0.35
compaction_value_alert_threshold = 0.6
